Measuring Meaning in Mixed Methods - Week 3
================

\#Topic Modeling using Latent Semantic Analysis

``` r
#We construct the example matrix
human <- c(1,0,0,1,0,0,0,0,0)
interface <- c(1,0,1,0,0,0,0,0,0)
computer <- c(1,1,0,0,0,0,0,0,0)
user <- c(0,1,1,0,1,0,0,0,0)
system <- c(0,1,1,2,0,0,0,0,0)
response <- c(0,1,0,0,1,0,0,0,0)
time <- c(0,1,0,0,1,0,0,0,0)
EPS <- c(0,0,1,1,0,0,0,0,0)
survey <- c(0,1,0,0,0,0,0,0,1)
trees <- c(0,0,0,0,0,1,1,1,0)
graph <- c(0,0,0,0,0,0,1,1,1)
minor <- c(0,0,0,0,0,0,0,1,1)
X <- rbind(human,interface,computer,user,system,response,time,EPS,survey,trees,graph,minor)
colnames(X) <- c("c1","c2","c3","c4","c5","m1","m2","m3","m4")
print(X)
```

    ##           c1 c2 c3 c4 c5 m1 m2 m3 m4
    ## human      1  0  0  1  0  0  0  0  0
    ## interface  1  0  1  0  0  0  0  0  0
    ## computer   1  1  0  0  0  0  0  0  0
    ## user       0  1  1  0  1  0  0  0  0
    ## system     0  1  1  2  0  0  0  0  0
    ## response   0  1  0  0  1  0  0  0  0
    ## time       0  1  0  0  1  0  0  0  0
    ## EPS        0  0  1  1  0  0  0  0  0
    ## survey     0  1  0  0  0  0  0  0  1
    ## trees      0  0  0  0  0  1  1  1  0
    ## graph      0  0  0  0  0  0  1  1  1
    ## minor      0  0  0  0  0  0  0  1  1

Measure the intial correlation between several rows

``` r
cor(human,user, method="spearman")
```

    ## [1] -0.3779645

``` r
cor(human,minor, method="spearman")
```

    ## [1] -0.2857143

Do the singular value decomposition on the X matrix

``` r
SVD <- svd(X)
print(SVD)
```

    ## $d
    ## [1] 3.3408838 2.5417010 2.3539435 1.6445323 1.5048316 1.3063820 0.8459031
    ## [8] 0.5601344 0.3636768
    ## 
    ## $u
    ##              [,1]        [,2]       [,3]          [,4]        [,5]
    ##  [1,] -0.22135078 -0.11317962  0.2889582 -0.4147507404 -0.10627512
    ##  [2,] -0.19764540 -0.07208778  0.1350396 -0.5522395837  0.28176894
    ##  [3,] -0.24047023  0.04315195 -0.1644291 -0.5949618181 -0.10675529
    ##  [4,] -0.40359886  0.05707026 -0.3378035  0.0991137295  0.33173372
    ##  [5,] -0.64448115 -0.16730121  0.3611482  0.3334616013 -0.15895498
    ##  [6,] -0.26503747  0.10715957 -0.4259985  0.0738121922  0.08031938
    ##  [7,] -0.26503747  0.10715957 -0.4259985  0.0738121922  0.08031938
    ##  [8,] -0.30082816 -0.14127047  0.3303084  0.1880919179  0.11478462
    ##  [9,] -0.20591786  0.27364743 -0.1775970 -0.0323519366 -0.53715000
    ## [10,] -0.01274618  0.49016179  0.2311202  0.0248019985  0.59416952
    ## [11,] -0.03613585  0.62278523  0.2230864  0.0007000721 -0.06825294
    ## [12,] -0.03175633  0.45050892  0.1411152 -0.0087294706 -0.30049511
    ##              [,6]         [,7]          [,8]        [,9]
    ##  [1,] -0.34098332 -0.522657771  0.0604501376  0.40667751
    ##  [2,]  0.49587801  0.070423441  0.0099400372  0.10893027
    ##  [3,] -0.25495513  0.302240236 -0.0623280150 -0.49244436
    ##  [4,]  0.38483192 -0.002872175  0.0003905042 -0.01232935
    ##  [5,] -0.20652259  0.165828575 -0.0342720233 -0.27069629
    ##  [6,] -0.16967639 -0.282915727  0.0161465472  0.05387469
    ##  [7,] -0.16967639 -0.282915727  0.0161465472  0.05387469
    ##  [8,]  0.27215528 -0.032994110  0.0189980144  0.16533917
    ##  [9,]  0.08094398  0.466897525  0.0362988295  0.57942611
    ## [10,] -0.39212506  0.288317461 -0.2545679452  0.22542407
    ## [11,]  0.11490895 -0.159575477  0.6811254380 -0.23196123
    ## [12,]  0.27734340 -0.339495286 -0.6784178789 -0.18253498
    ## 
    ## $v
    ##               [,1]        [,2]        [,3]        [,4]        [,5]
    ##  [1,] -0.197392802 -0.05591352  0.11026973 -0.94978502  0.04567856
    ##  [2,] -0.605990269  0.16559288 -0.49732649 -0.02864890 -0.20632728
    ##  [3,] -0.462917508 -0.12731206  0.20760595  0.04160920  0.37833623
    ##  [4,] -0.542114417 -0.23175523  0.56992145  0.26771404 -0.20560471
    ##  [5,] -0.279469108  0.10677472 -0.50544991  0.15003543  0.32719441
    ##  [6,] -0.003815213  0.19284794  0.09818424  0.01508149  0.39484121
    ##  [7,] -0.014631468  0.43787488  0.19295557  0.01550719  0.34948535
    ##  [8,] -0.024136835  0.61512190  0.25290398  0.01019901  0.14979847
    ##  [9,] -0.081957368  0.52993707  0.07927315 -0.02455491 -0.60199299
    ##                [,6]        [,7]         [,8]        [,9]
    ##  [1,] -7.659356e-02 -0.17731830  0.014393259  0.06369229
    ##  [2,] -2.564752e-01  0.43298424 -0.049305326 -0.24278290
    ##  [3,]  7.243996e-01  0.23688970 -0.008825502 -0.02407687
    ##  [4,] -3.688609e-01 -0.26479952  0.019466944  0.08420690
    ##  [5,]  3.481305e-02 -0.67230353  0.058349563  0.26237588
    ##  [6,] -3.001611e-01  0.34083983 -0.454476523  0.61984719
    ##  [7,] -2.122014e-01  0.15219472  0.761527011 -0.01797518
    ##  [8,]  9.743417e-05 -0.24914592 -0.449642757 -0.51989050
    ##  [9,]  3.622190e-01 -0.03803419  0.069637550  0.45350675

``` r
rownames(SVD$u) = rownames(X) 
rownames(SVD$v) = colnames(X)
u <- as.matrix(SVD$u)
v <- as.matrix(SVD$v)
d <- SVD$d
```

We can set all but the first two singular values to zero. this means
that r=2

``` r
d[3:9] <- 0
d_r <- as.matrix(diag(d))
print(d_r)
```

    ##           [,1]     [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
    ##  [1,] 3.340884 0.000000    0    0    0    0    0    0    0
    ##  [2,] 0.000000 2.541701    0    0    0    0    0    0    0
    ##  [3,] 0.000000 0.000000    0    0    0    0    0    0    0
    ##  [4,] 0.000000 0.000000    0    0    0    0    0    0    0
    ##  [5,] 0.000000 0.000000    0    0    0    0    0    0    0
    ##  [6,] 0.000000 0.000000    0    0    0    0    0    0    0
    ##  [7,] 0.000000 0.000000    0    0    0    0    0    0    0
    ##  [8,] 0.000000 0.000000    0    0    0    0    0    0    0
    ##  [9,] 0.000000 0.000000    0    0    0    0    0    0    0

We put the matrix back together but now with only keeping the first two
singular values.

``` r
X_r <- u %*% d_r %*% t(v)
print(round(X_r,2))
```

    ##              c1   c2    c3    c4   c5    m1    m2    m3    m4
    ## human      0.16 0.40  0.38  0.47 0.18 -0.05 -0.12 -0.16 -0.09
    ## interface  0.14 0.37  0.33  0.40 0.16 -0.03 -0.07 -0.10 -0.04
    ## computer   0.15 0.51  0.36  0.41 0.24  0.02  0.06  0.09  0.12
    ## user       0.26 0.84  0.61  0.70 0.39  0.03  0.08  0.12  0.19
    ## system     0.45 1.23  1.05  1.27 0.56 -0.07 -0.15 -0.21 -0.05
    ## response   0.16 0.58  0.38  0.42 0.28  0.06  0.13  0.19  0.22
    ## time       0.16 0.58  0.38  0.42 0.28  0.06  0.13  0.19  0.22
    ## EPS        0.22 0.55  0.51  0.63 0.24 -0.07 -0.14 -0.20 -0.11
    ## survey     0.10 0.53  0.23  0.21 0.27  0.14  0.31  0.44  0.42
    ## trees     -0.06 0.23 -0.14 -0.27 0.14  0.24  0.55  0.77  0.66
    ## graph     -0.06 0.34 -0.15 -0.30 0.20  0.31  0.69  0.98  0.85
    ## minor     -0.04 0.25 -0.10 -0.21 0.15  0.22  0.50  0.71  0.62

We measure the correlations among the rows(=the words)

``` r
cor(t(X_r), method="pearson")
```

    ##                human   interface   computer       user      system
    ## human      1.0000000  0.99845002  0.9272372  0.9385327  0.99477179
    ## interface  0.9984500  1.00000000  0.9466417  0.9562898  0.99891364
    ## computer   0.9272372  0.94664167  1.0000000  0.9995074  0.96063185
    ## user       0.9385327  0.95628979  0.9995074  1.0000000  0.96887768
    ## system     0.9947718  0.99891364  0.9606319  0.9688777  1.00000000
    ## response   0.8237876  0.85406187  0.9761356  0.9688395  0.87737397
    ## time       0.8237876  0.85406187  0.9761356  0.9688395  0.87737397
    ## EPS        0.9998896  0.99916675  0.9326989  0.9435580  0.99617934
    ## survey    -0.1246923 -0.06927775  0.2559325  0.2254685 -0.02271458
    ## trees     -0.8502599 -0.81964690 -0.5912831 -0.6163012 -0.79206083
    ## graph     -0.8365821 -0.80479496 -0.5705575 -0.5960501 -0.77626117
    ## minor     -0.8309233 -0.79866924 -0.5621103 -0.5877892 -0.76975918
    ##             response       time        EPS      survey      trees
    ## human      0.8237876  0.8237876  0.9998896 -0.12469235 -0.8502599
    ## interface  0.8540619  0.8540619  0.9991667 -0.06927775 -0.8196469
    ## computer   0.9761356  0.9761356  0.9326989  0.25593246 -0.5912831
    ## user       0.9688395  0.9688395  0.9435580  0.22546848 -0.6163012
    ## system     0.8773740  0.8773740  0.9961793 -0.02271458 -0.7920608
    ## response   1.0000000  1.0000000  0.8321198  0.45975419 -0.4020390
    ## time       1.0000000  1.0000000  0.8321198  0.45975419 -0.4020390
    ## EPS        0.8321198  0.8321198  1.0000000 -0.10993632 -0.8423452
    ## survey     0.4597542  0.4597542 -0.1099363  1.00000000  0.6282760
    ## trees     -0.4020390 -0.4020390 -0.8423452  0.62827599  1.0000000
    ## graph     -0.3785954 -0.3785954 -0.8283498  0.64788125  0.9996758
    ## minor     -0.3690892 -0.3690892 -0.8225646  0.65565446  0.9993623
    ##                graph      minor
    ## human     -0.8365821 -0.8309233
    ## interface -0.8047950 -0.7986692
    ## computer  -0.5705575 -0.5621103
    ## user      -0.5960501 -0.5877892
    ## system    -0.7762612 -0.7697592
    ## response  -0.3785954 -0.3690892
    ## time      -0.3785954 -0.3690892
    ## EPS       -0.8283498 -0.8225646
    ## survey     0.6478812  0.6556545
    ## trees      0.9996758  0.9993623
    ## graph      1.0000000  0.9999475
    ## minor      0.9999475  1.0000000

``` r
cor(t(X_r), method="spearman")
```

    ##                human  interface   computer       user     system
    ## human      1.0000000  1.0000000  0.8666667  0.8666667  0.9833333
    ## interface  1.0000000  1.0000000  0.8666667  0.8666667  0.9833333
    ## computer   0.8666667  0.8666667  1.0000000  1.0000000  0.9166667
    ## user       0.8666667  0.8666667  1.0000000  1.0000000  0.9166667
    ## system     0.9833333  0.9833333  0.9166667  0.9166667  1.0000000
    ## response   0.7666667  0.7666667  0.9500000  0.9500000  0.8333333
    ## time       0.7666667  0.7666667  0.9500000  0.9500000  0.8333333
    ## EPS        1.0000000  1.0000000  0.8666667  0.8666667  0.9833333
    ## survey    -0.2333333 -0.2333333  0.1500000  0.1500000 -0.1500000
    ## trees     -0.8666667 -0.8666667 -0.6666667 -0.6666667 -0.8333333
    ## graph     -0.8000000 -0.8000000 -0.5333333 -0.5333333 -0.7500000
    ## minor     -0.8000000 -0.8000000 -0.5333333 -0.5333333 -0.7500000
    ##             response       time        EPS     survey      trees
    ## human      0.7666667  0.7666667  1.0000000 -0.2333333 -0.8666667
    ## interface  0.7666667  0.7666667  1.0000000 -0.2333333 -0.8666667
    ## computer   0.9500000  0.9500000  0.8666667  0.1500000 -0.6666667
    ## user       0.9500000  0.9500000  0.8666667  0.1500000 -0.6666667
    ## system     0.8333333  0.8333333  0.9833333 -0.1500000 -0.8333333
    ## response   1.0000000  1.0000000  0.7666667  0.3666667 -0.4833333
    ## time       1.0000000  1.0000000  0.7666667  0.3666667 -0.4833333
    ## EPS        0.7666667  0.7666667  1.0000000 -0.2333333 -0.8666667
    ## survey     0.3666667  0.3666667 -0.2333333  1.0000000  0.6000000
    ## trees     -0.4833333 -0.4833333 -0.8666667  0.6000000  1.0000000
    ## graph     -0.3500000 -0.3500000 -0.8000000  0.7166667  0.9833333
    ## minor     -0.3500000 -0.3500000 -0.8000000  0.7166667  0.9833333
    ##                graph      minor
    ## human     -0.8000000 -0.8000000
    ## interface -0.8000000 -0.8000000
    ## computer  -0.5333333 -0.5333333
    ## user      -0.5333333 -0.5333333
    ## system    -0.7500000 -0.7500000
    ## response  -0.3500000 -0.3500000
    ## time      -0.3500000 -0.3500000
    ## EPS       -0.8000000 -0.8000000
    ## survey     0.7166667  0.7166667
    ## trees      0.9833333  0.9833333
    ## graph      1.0000000  1.0000000
    ## minor      1.0000000  1.0000000

We measure the correlations among the columns(=the documents)

``` r
cor(X,method="pearson")
```

    ##            c1         c2         c3         c4         c5         m1
    ## c1  1.0000000 -0.1924501  0.0000000  0.0000000 -0.3333333 -0.1740777
    ## c2 -0.1924501  1.0000000  0.0000000  0.0000000  0.5773503 -0.3015113
    ## c3  0.0000000  0.0000000  1.0000000  0.4724556  0.0000000 -0.2132007
    ## c4  0.0000000  0.0000000  0.4724556  1.0000000 -0.3086067 -0.1611646
    ## c5 -0.3333333  0.5773503  0.0000000 -0.3086067  1.0000000 -0.1740777
    ## m1 -0.1740777 -0.3015113 -0.2132007 -0.1611646 -0.1740777  1.0000000
    ## m2 -0.2581989 -0.4472136 -0.3162278 -0.2390457 -0.2581989  0.6741999
    ## m3 -0.3333333 -0.5773503 -0.4082483 -0.3086067 -0.3333333  0.5222330
    ## m4 -0.3333333 -0.1924501 -0.4082483 -0.3086067 -0.3333333 -0.1740777
    ##            m2         m3         m4
    ## c1 -0.2581989 -0.3333333 -0.3333333
    ## c2 -0.4472136 -0.5773503 -0.1924501
    ## c3 -0.3162278 -0.4082483 -0.4082483
    ## c4 -0.2390457 -0.3086067 -0.3086067
    ## c5 -0.2581989 -0.3333333 -0.3333333
    ## m1  0.6741999  0.5222330 -0.1740777
    ## m2  1.0000000  0.7745967  0.2581989
    ## m3  0.7745967  1.0000000  0.5555556
    ## m4  0.2581989  0.5555556  1.0000000

``` r
cor((X_r), method="pearson")
```

    ##            c1         c2         c3         c4         c5         m1
    ## c1  1.0000000  0.9104833  0.9999927  0.9982333  0.8421953 -0.8575202
    ## c2  0.9104833  1.0000000  0.9120522  0.8843032  0.9897773 -0.5680091
    ## c3  0.9999927  0.9120522  1.0000000  0.9979997  0.8442433 -0.8555541
    ## c4  0.9982333  0.8843032  0.9979997  1.0000000  0.8086715 -0.8865721
    ## c5  0.8421953  0.9897773  0.8442433  0.8086715  1.0000000 -0.4448221
    ## m1 -0.8575202 -0.5680091 -0.8555541 -0.8865721 -0.4448221  1.0000000
    ## m2 -0.8534623 -0.5615419 -0.8514707 -0.8829197 -0.4377897  0.9999693
    ## m3 -0.8516895 -0.5587317 -0.8496868 -0.8813219 -0.4347372  0.9999370
    ## m4 -0.8111922 -0.4967438 -0.8089585 -0.8445047 -0.3678851  0.9964537
    ##            m2         m3         m4
    ## c1 -0.8534623 -0.8516895 -0.8111922
    ## c2 -0.5615419 -0.5587317 -0.4967438
    ## c3 -0.8514707 -0.8496868 -0.8089585
    ## c4 -0.8829197 -0.8813219 -0.8445047
    ## c5 -0.4377897 -0.4347372 -0.3678851
    ## m1  0.9999693  0.9999370  0.9964537
    ## m2  1.0000000  0.9999942  0.9970825
    ## m3  0.9999942  1.0000000  0.9973357
    ## m4  0.9970825  0.9973357  1.0000000

The differences between the different topics should now be more clearly
defined.
